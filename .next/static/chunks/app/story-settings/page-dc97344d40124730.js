(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[182],{63:(e,t,a)=>{"use strict";var r=a(7260);a.o(r,"useRouter")&&a.d(t,{useRouter:function(){return r.useRouter}}),a.o(r,"useSearchParams")&&a.d(t,{useSearchParams:function(){return r.useSearchParams}})},358:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(4294).A)("GitBranch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]])},805:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(4294).A)("WandSparkles",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]])},926:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var a in t)Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}(t,{callServer:function(){return r.callServer},createServerReference:function(){return s.createServerReference},findSourceMapURL:function(){return n.findSourceMapURL}});let r=a(1209),n=a(5153),s=a(7197)},1680:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>m});var r=a(5155),n=a(2115),s=a(63),o=a(926);let l=(0,o.createServerReference)("7f68d4a9738f65d67d6325f587c36357091304f259",o.callServer,void 0,o.findSourceMapURL,"generateAndSaveInteractiveStory"),i=(0,o.createServerReference)("7fe26f3219367bec4a83badc0205af817a12cbba34",o.callServer,void 0,o.findSourceMapURL,"generateAndSaveStory");var c=a(3017),d=a(805),p=a(7187),x=a(358),h=a(9338);function u(){let e=(0,s.useRouter)(),t=(0,s.useSearchParams)(),a=t.get("hero1Name")||"",o=parseInt(t.get("hero1Age")||"6"),u=t.get("hero1Type")||"Chevalier",m=t.get("hero2Name"),b=t.get("hero2Age")?parseInt(t.get("hero2Age")):null,g=t.get("hero2Type"),v=t.get("world")||"For\xeat Enchant\xe9e",f=!!m,[k,w]=(0,n.useState)("Aventure"),[N,y]=(0,n.useState)("linear"),[j,A]=(0,n.useState)(!1),[_,C]=(0,n.useState)(!1),[R,S]=(0,n.useState)(""),E=async()=>{(0,c.N)(),A(!0),C(!0),S("Cr\xe9ation des profils...");try{if("interactive"===N){S("G\xe9n\xe9ration de l'histoire interactive avec l'IA...");let t=await l(a,o,u,m,b,g,v,k);if(t.error||!t.data){alert(t.error||"Erreur de g\xe9n\xe9ration"),A(!1),C(!1);return}S("Sauvegarde des chapitres...");let{title:r,storyId:n,coverImageUrl:s}=t.data;console.log("Histoire interactive g\xe9n\xe9r\xe9e:",{title:r,storyId:n}),e.push("/read-story?id=".concat(n,"&interactive=true&hero1Name=").concat(encodeURIComponent(a),"&hero2Name=").concat(m?encodeURIComponent(m):"","&world=").concat(encodeURIComponent(v),"&theme=").concat(k,"&title=").concat(encodeURIComponent(r),"&imageUrl=").concat(s?encodeURIComponent(s):""))}else{S("G\xe9n\xe9ration de l'histoire avec l'IA...");let t=await i(a,o,u,m,b,g,v,k);if(t.error||!t.data){alert(t.error||"Erreur de g\xe9n\xe9ration"),A(!1),C(!1);return}S("Sauvegarde et pr\xe9paration...");let{title:r,content:n,imageUrl:s,storyId:l}=t.data;console.log("Story g\xe9n\xe9r\xe9e:",{title:r,imageUrl:null==s?void 0:s.substring(0,50),storyId:l});let c=encodeURIComponent(r),d=encodeURIComponent(n),p=s?encodeURIComponent(s):"";if(!l){alert("Erreur: L'histoire n'a pas \xe9t\xe9 sauvegard\xe9e correctement"),A(!1),C(!1);return}e.push("/read-story?id=".concat(l,"&hero1Name=").concat(encodeURIComponent(a),"&hero2Name=").concat(m?encodeURIComponent(m):"","&world=").concat(encodeURIComponent(v),"&theme=").concat(k,"&title=").concat(c,"&content=").concat(d,"&imageUrl=").concat(p))}}catch(e){console.error("Erreur:",e),alert("Oups, la magie a eu un petit rat\xe9. R\xe9essaie !"),A(!1),C(!1)}};return(0,r.jsxs)("div",{className:"max-w-2xl mx-auto flex flex-col gap-6 px-4",children:[(0,r.jsxs)("div",{className:"bg-indigo-950 border-4 border-black text-sm p-4 w-full shadow-[4px_4px_0px_0px_rgba(0,0,0,1)]",children:[(0,r.jsx)("span",{className:"font-bold text-amber-500 uppercase",children:"AVENTURE :"})," ",(0,r.jsx)("span",{className:"text-amber-400 font-black",children:a}),f&&(0,r.jsxs)(r.Fragment,{children:[" ",(0,r.jsx)("span",{className:"text-white",children:"et"})," ",(0,r.jsx)("span",{className:"text-purple-400 font-black",children:m})]})," ",(0,r.jsx)("span",{className:"text-amber-500",children:"DANS"})," ",(0,r.jsx)("span",{className:"text-white uppercase font-black",children:v})]}),_&&(0,r.jsxs)("div",{className:"bg-gradient-to-r from-purple-900 to-indigo-900 border-4 border-amber-500 p-6 rounded-lg text-center animate-pulse",children:[(0,r.jsx)(d.A,{className:"w-12 h-12 text-amber-400 mx-auto mb-3 animate-bounce"}),(0,r.jsx)("p",{className:"text-white font-bold text-lg",children:"interactive"===N?"L'IA cr\xe9e l'histoire interactive ".concat(f?"des deux h\xe9ros":"de ton h\xe9ros","..."):"L'IA cr\xe9e l'histoire ".concat(f?"des deux h\xe9ros":"de ton h\xe9ros","...")}),(0,r.jsx)("p",{className:"text-indigo-300 text-sm mt-2",children:R}),(0,r.jsx)("div",{className:"mt-4 w-full bg-indigo-800 rounded-full h-2",children:(0,r.jsx)("div",{className:"bg-amber-500 h-2 rounded-full animate-pulse w-3/4"})}),(0,r.jsx)("p",{className:"text-indigo-400 text-xs mt-3",children:"interactive"===N?"✨ G\xe9n\xe9ration de l'arbre narratif avec choix et embranchements ✨":"✨ G\xe9n\xe9ration du texte et de l'illustration ✨"}),(0,r.jsx)("p",{className:"text-indigo-500 text-xs mt-1",children:"interactive"===N?"Cela prend environ 20-30 secondes":"Cela prend environ 15-20 secondes"})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsx)("label",{className:"bg-purple-500 text-white font-bold py-1 px-3 border-2 border-black uppercase text-xs self-start transform -rotate-1",children:"Type d'histoire"}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,r.jsxs)("button",{onClick:()=>y("linear"),disabled:j,className:"p-4 border-4 border-black shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] transition-all text-left ".concat("linear"===N?"bg-amber-500 text-black":"bg-slate-800 text-white hover:bg-slate-700"),children:[(0,r.jsx)(p.A,{className:"w-6 h-6 mb-2"}),(0,r.jsx)("div",{className:"font-black text-sm uppercase",children:"Histoire Classique"}),(0,r.jsx)("div",{className:"text-xs opacity-80 mt-1",children:"Une belle histoire lin\xe9aire \xe0 lire"})]}),(0,r.jsxs)("button",{onClick:()=>y("interactive"),disabled:j,className:"p-4 border-4 border-black shadow-[4px_4px_0px_0px_rgba(0,0,0,1)] transition-all text-left ".concat("interactive"===N?"bg-purple-500 text-white":"bg-slate-800 text-white hover:bg-slate-700"),children:[(0,r.jsx)(x.A,{className:"w-6 h-6 mb-2"}),(0,r.jsx)("div",{className:"font-black text-sm uppercase",children:"\uD83C\uDFAD Dont vous \xeates le h\xe9ros"}),(0,r.jsx)("div",{className:"text-xs opacity-80 mt-1",children:"2 choix qui changent l'histoire !"})]})]})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,r.jsx)("label",{className:"bg-amber-500 text-black font-bold py-1 px-3 border-2 border-black uppercase text-xs self-start transform -rotate-1",children:"Th\xe8me de l'histoire"}),(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsxs)("select",{value:k,onChange:e=>w(e.target.value),className:"w-full p-4 bg-slate-900 text-white border-4 border-black shadow-[6px_6px_0px_0px_rgba(0,0,0,1)] outline-none font-bold appearance-none cursor-pointer",disabled:j,children:[(0,r.jsx)("option",{className:"bg-slate-900 text-white",value:"Aventure",children:"⚔️ Aventure (Action et Courage)"}),(0,r.jsx)("option",{className:"bg-slate-900 text-white",value:"Amiti\xe9",children:"\uD83E\uDD1D Amiti\xe9 (Entraide et Partage)"}),(0,r.jsx)("option",{className:"bg-slate-900 text-white",value:"Apprentissage",children:"\uD83D\uDCDA Apprentissage (D\xe9couverte et Sagesse)"})]}),(0,r.jsx)("div",{className:"absolute right-4 top-1/2 -translate-y-1/2 pointer-events-none text-amber-500 font-black",children:"▼"})]})]}),(0,r.jsxs)("div",{className:"pt-6 flex flex-col gap-4",children:[(0,r.jsx)("button",{onClick:E,disabled:j,className:"group bg-gradient-to-r ".concat("interactive"===N?"from-purple-500 via-pink-500 to-purple-500 hover:from-purple-400 hover:via-pink-400 hover:to-purple-400":"from-amber-500 via-orange-500 to-amber-500 hover:from-amber-400 hover:via-orange-400 hover:to-amber-400"," text-black font-black py-6 px-10 border-4 border-black shadow-[8px_8px_0px_0px_rgba(0,0,0,1)] text-2xl w-full transition-all active:translate-x-2 active:translate-y-2 active:shadow-none uppercase tracking-tighter flex items-center justify-center gap-3 ").concat(j?"opacity-50 grayscale cursor-not-allowed":""),children:j?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(h.A,{className:"w-6 h-6 animate-spin"}),"CR\xc9ATION EN COURS..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(d.A,{className:"w-6 h-6 group-hover:rotate-12 transition-transform"}),"interactive"===N?"CR\xc9ER L'AVENTURE INTERACTIVE \uD83C\uDFAD":"CR\xc9ER LA MAGIE ✨"]})}),(0,r.jsxs)("a",{href:"/library",onClick:()=>(0,c.N)(),className:"bg-indigo-800 text-white font-black py-4 px-8 border-4 border-black shadow-[6px_6px_0px_0px_rgba(0,0,0,1)] text-xl w-full transition-all active:translate-x-1 active:translate-y-1 active:shadow-none uppercase tracking-tighter flex items-center justify-center gap-2 hover:bg-indigo-700 text-center",children:[(0,r.jsx)(p.A,{className:"w-5 h-5"}),"Voir mes histoires"]}),(0,r.jsx)("button",{onClick:()=>{(0,c.N)(),window.history.back()},disabled:j,className:"bg-indigo-950 text-white font-black py-4 px-8 border-4 border-black shadow-[6px_6px_0px_0px_rgba(0,0,0,1)] text-xl w-full transition-transform active:translate-x-1 active:translate-y-1 active:shadow-none uppercase tracking-tighter",children:"Retour"})]})]})}function m(){return(0,r.jsxs)("main",{className:"min-h-screen p-6 bg-[#0f0f1a]",children:[(0,r.jsxs)("div",{className:"max-w-2xl mx-auto px-4 mb-10 transform -rotate-1",children:[(0,r.jsx)("h1",{className:"text-amber-500 text-2xl font-black uppercase text-center mb-2 tracking-widest drop-shadow-[2px_2px_0px_rgba(0,0,0,1)]",children:"MagicStory"}),(0,r.jsx)("h2",{className:"text-3xl font-black text-center text-white uppercase drop-shadow-[4px_4px_0px_rgba(0,0,0,1)] break-words",children:"Derniers d\xe9tails..."})]}),(0,r.jsx)(n.Suspense,{fallback:(0,r.jsx)("div",{className:"text-center font-bold text-amber-500 uppercase tracking-widest animate-pulse",children:"Chargement de tes choix..."}),children:(0,r.jsx)(u,{})})]})}},3017:(e,t,a)=>{"use strict";a.d(t,{N:()=>r});let r=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;window.navigator&&window.navigator.vibrate&&window.navigator.vibrate(e)}},4294:(e,t,a)=>{"use strict";a.d(t,{A:()=>l});var r=a(2115);let n=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.filter((e,t,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===t).join(" ").trim()};var s={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let o=(0,r.forwardRef)((e,t)=>{let{color:a="currentColor",size:o=24,strokeWidth:l=2,absoluteStrokeWidth:i,className:c="",children:d,iconNode:p,...x}=e;return(0,r.createElement)("svg",{ref:t,...s,width:o,height:o,stroke:a,strokeWidth:i?24*Number(l)/Number(o):l,className:n("lucide",c),...x},[...p.map(e=>{let[t,a]=e;return(0,r.createElement)(t,a)}),...Array.isArray(d)?d:[d]])}),l=(e,t)=>{let a=(0,r.forwardRef)((a,s)=>{let{className:l,...i}=a;return(0,r.createElement)(o,{ref:s,iconNode:t,className:n("lucide-".concat(e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),l),...i})});return a.displayName="".concat(e),a}},6222:(e,t,a)=>{Promise.resolve().then(a.bind(a,1680))},7187:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(4294).A)("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]])},9338:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(4294).A)("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]])}},e=>{e.O(0,[441,255,358],()=>e(e.s=6222)),_N_E=e.O()}]);